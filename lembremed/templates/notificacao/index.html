{% extends 'base.html' %}
{% load static %}

{% block title %}LembreMED - Notificações{% endblock %}

{% block content %}
<main class="main-content">
	<section class="instituicoes-container notificacoes-container">
		<h2 class="section-title notificacoes-title">Notificações</h2>

		{% if estoque_acabando %}
			<div class="moradores-cards notificacoes-cards">
				{% for estoque in estoque_acabando %}
					<div class="instituicao-card notificacao-card">
						<div class="instituicao-info">
							<p class="alerta">⚠ Estoque acabando!</p>
							<p><strong>Hóspede:</strong> {{ estoque.morador.nome }}</p>
							<p><strong>Medicamento:</strong> {{ estoque.medicamento.principio }} ({{ estoque.apresentacao.unidade_prescricao }})</p>
							<p><strong>Duração estimada:</strong> {{ estoque.estimativa_duracao|floatformat:0 }} dia(s)</p>
						</div>
					</div>
				{% endfor %}
			</div>
		{% else %}
			<div class="notificacoes-vazia-container">
				<p class="notificacoes-vazia">
					Nenhuma notificação no momento
				</p>
			</div>
		{% endif %}
	</section>
</main>

<script>
	$(document).ready(function() {
		$('.cnpj').mask('00.000.000/0000-00');

		$('.cnpj').each(function() {
			var cnpj = $(this).text().replace(/\D/g, '');
			if (cnpj.length === 14) {
				cnpj = cnpj.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, "$1.$2.$3/$4-$5");
				$(this).text(cnpj);
			}
		});
	});
</script>
{% endblock %}
